# 디렉터리와 파일

**목차**

1. [구성](#구성)
2. [종류](#종류)
3. [디렉터리와 파일 관리](#디렉터리와-파일-관리)
   * [디렉터리 구조](#디렉터리-구조)
   * [절대 경로와 상대 경로](#절대-경로와-상대-경로)
   * [디렉터리 내용 확인](#디렉터리-내용-확인)
   * [디렉터리 생성](#디렉터리-생성)
   * [디렉터리 제거](#디렉터리-제거)
   * [파일 생성](#파일-생성)
   * [파일 복사](#파일-복사)
   * [파일 내부 정보 읽기](#파일-내부-정보-읽기)
   * [파일 찾기](#파일-찾기)
   * [파일 이동](#파일-이동)

---

## 구성

**리눅스 시스템에서는 모든 처리 과정을 파일 단위로 처리**

* 파일의 구성은 계층적인 구조의 특성을 지님

**파일의 3 가지 요소 (중요)**

* **파일 이름** 

  * 사용자가 파일을 사용 목적에 맞도록 사용하고 해당 파일에 정확히 접근할 수 있도록 구별할 수 있는 변별력 제공
  * 리눅스 시스템에서는 파일의 속성을 지정하는 특별한 확장명은 제공되지 않는다 (확장자 정해져 있지 않다)
  * 리눅스 시스템에서 관리하는 모든 데이터는 파일이라는 단일 인터페이스를 지니고 있다

* **i-node (고유한 정보 값)** 

  * `Index Node` 의 줄임말로 파일을 기술하는 디스크 상 에서의 데이터 구조를 의미
  * 하나의 파일 생성 시 하나의 i-node 가 생성
    * 파일을 구별할 수 있도록 i-node 번호가 부여된다
  * **저장된 정보**
    * 파일의 종류
    * 파일의 소유권 - 사용자 (소유자) 와 그룹
    * 파일의 액세스 모드 (파일의 용도)
    * 파일의 타임 스탬프 (파일 갱신일)

* **데이터 블록**

  * 파일에서 데이터를 저장하는 블록을 의미

  * 일반 파일이나 디렉터리 파일의 데이터가 존재

  * 디스크 장치에 파일을 저장할 때 실제 데이터는 특별한 구분 없이 디스크에 저장하며 디스크의 어느 한 곳에 차례대로 쌓여있는 부분을 데이터 블록이라 한다

    ![블록](C:/daou/01.linux/doc/assets/datablock.png)

---

## 종류

![파일](C:/daou/01.linux/doc/assets/directory.png)

**일반 파일**

* 데이터를 저장하는 파일이거나 실행하는 파일
* 실행 파일이나 이미지 파일의 경우 데이터가 바이너리 형태로 저장
* 일반 파일을 정규 파일이라고도 하며 정규 파일은 표준 입출력 시스템의 호출을 통해 참조된다

**디렉터리 파일**

* 디렉터리 (폴더) 를 의미 : 리눅스에서는 디렉터리 역시 파일로 취급된다
* 일반 파일과 마찬가지로 디스크에 저장돼 다른 파일을 조작하고 액세스하는데 필요한 정보 공유
* 디렉터리라는 파일을 이용해 전체 파일을 하나의 트리 구조로 관리

**특수 파일**

* 리눅스가 지원하는 **파이프, 소켓, 주변 장치 (디바이스)** 의미
  * 디바이스의 경우, 윈도우에서는 `C:`, `D:` 등으로 표시되지만 리눅스 시스템에서는 `/dev/hda1` 등으로 사용 된다
  * 파일의 영역은 키보드, 모니터, 마우스, 디스크 드라이브 등과 같이 컴퓨터의 모든 자원이 특수 파일로 사용되고 다뤄진다

**기타 다른 파일**

* 문서 파일과 이진 파일 (실행 파일)

* 링크 파일

  * 링크라는 개념을 도입해 여러 개의 이름이 하나의 I-node 에 연결되도록 수행해 실제 파일이나 디렉터리 혹은 다른 링크를 가리킴

  * 링크 추가 = 디렉터리 엔트리 생성하는 것 의미

  * 파일에는 하드 링크와 심볼릭 링크가 존재하며 링크 파일을 생성하기 위해서는 `ln` 사용

    ![link](C:/daou/01.linux/doc/assets/ln.png)

    * 현재 test_hosts 는 같은 i-node 가지고 있으므로 하드 링크

      * root 앞 숫자는 원본 개수를 나타낸다

    * **하드 링크**

      * 원본 파일 복사해 원본 파일과 동일한 내용의 다른 사본 파일을 만드는 것
      * 원본 / 링크 파일을 서로 다른 파일로 취급, 둘 중 하나를 삭제하더라도 나머지 하나는 남아 있다
      * 원본 파일의 내용이 변경될 경우 복사된 링크 파일의 내용 또한 자동으로 변경
      * 하드 링크는 동일한 I-node 를 갖기 때문에 (정보 공유) 마치 동일한 파일이 여러 곳에 존재하는 것처럼 보이게 된다

    * **심볼릭 링크 (소프트 링크)**

      * 리눅스 시스템에서 통상적으로 사용

      * 윈도우 OS 의 바로 가기 기능이나 단축 아이콘 같은 역할

      * 삭제해도 존재 된 원본 파일에는 영향 미치지 않는다

        ![링크](C:/daou/01.linux/doc/assets/symboliclink.png)

        * test_hosts.ln2 &rarr; test_hosts 라고 링크가 표시되며, i-node 가 다르다

* 등등

--

## 디렉터리와 파일 관리

```bash
# print working directory
# 현재 작업 디렉터리 위치 출력

pwd
```

### **디렉터리 구조**

![구조](C:/daou/01.linux/doc/assets/FHP.png)

| 디렉터리 | 설명                                                         |
| -------- | ------------------------------------------------------------ |
| `bin@`   | 기본 명령어가 존재하는 심볼릭 링크 파일                      |
| `dev/`   | 시스템 디바이스 장치 파일이 존재하는 디렉터리                |
| `boot/`  | 리눅스 커널 등 부팅 시 필요한 파일들 포함                    |
| `etc/`   | 응용 프로그램의 설정 파일 등을 포함                          |
| `lib@`   | 공유 라이브러리가 존재하는 심볼릭 링크 파일                  |
| `home/`  | 일반 사용자들이 사용하는 홈 디렉터리                         |
| `tmp/`   | 시스템 임시 디렉터리로 다음 부팅 시 까지의 사용 될 임시 파일 저장 |
| `var/`   | 로그, 스풀, 메일 및 임시 파일을 포함                         |
| `lib64@` | 64 bit 운영체제 호환성과 관련된 파일이 존재하는 심볼릭 링크 파일 |
| `mnt/`   | 입/출력장치 등 파일 시스템을 임시로 마운트 하는 디렉터리     |
| `proc/`  | 프로세스 정보 등 커널 관련 정보가 저장되는 디렉터리          |
| `run/`   | 실행 중인 서비스와 관련된 파일이 저장되는 디렉터리           |
| `media/` | usb 메모리 등 임시로 마운트 되는 이동식 장치를 위한 디렉터리 |
| `srv/`   | FTP 또는 web 등 시스템에서 제공하는 서비스 데이터가 저장되는 디렉터리 |
| `usr/`   | 기본 실행 파일과 라이브러리 파일, 헤더 파일 등의 파일이 존재하는 디렉터리 |
| `sys/`   | 리눅스 커널과 관련된 파일이 존재하는 디렉터리                |
| `sbin@`  | 시스템 운영 관련 파일이 존재하는 심볼릭 링크 파일            |
| `root/`  | root 계정의 홈 디렉터리로 `/` (루트) 디렉터리와 성격이 다른 디렉터리 |
| `opt/`   | 리눅스 시스템에 존재하지 않는 프로그램이 추가 설치 되는 디렉터리 (3-rd Party 라이브러리) |

**작업 디렉터리**

사용자가 리눅스 시스템에 접속해 현재 사용하고 있는 디렉터리 의미

* 현재 작업 중 디렉터리는 `.` 으로 표시
* 현재 작업 중 디렉터리 확인 위해서는 pwd 명령 사용

**홈 디렉터리**

각 사용자에게 할당되는 디렉터리로 사용자 계정을 처음 만들 때 지정

* 홈 디렉터리의 표시는 `~` (틸드) 를 사용
* `guest_01` 계정의 홈 디렉터리는 `guest_01~` 과 같이 표시 된다

### **절대 경로와 상대 경로**

* 리눅스 시스템에서 제공하고 있는 경로는 특정 파일이나 디렉터리의 위치를 나타내 준다

* 경로의 구분자는 `/` (슬래시)

  ```bash
  # 디렉토리 위치 이동
  # change directory
  
  cd
  ```

* **절대 경로**

  * 기준점 X, 어떤 위치더라도 접근할 수 있는 경로 (모든 경로를 전부 작성)

* **상대 경로**

  * 기준점을 기반으로 위치 설명 / 현재 작업하고 있는 디렉터리를 기준으로 계산된 상대적 경로

  - **.** : 현재 작업하는 위치

  - **..** : 현재 작업하는 위치의 상위 위치 (상위 폴더 / 부모 폴더)

---

## 명령어

### **디렉터리 내용 확인**

list 의 약어인 ls 명령으로 디렉터리 내용 확인

```bash
# 디렉터리에 존재하는 파일이나 서브 디렉터리에 대한 정보 확인

ls [옵션] [파일명 또는 디렉터리명]
```

* 옵션
  * **`-a`** 숨겨 진 파일까지 포함해 모든 파일 리스트 출력
  * `-d` 지정한 디렉터리에 존재하는 파일과 디렉터리 정보 출력
  * **`-i`** 첫 번째 열에 i-node 번호를 출력
  * `-n` 호스트 네임 확인
  * **`-l`** 파일의 상세한 정보를 출력
  * **`-F`** 파일의 종류를 실행 파일은 `*` , 디렉터리는 `/` , 심볼릭 링크는 `@` 로 표시
  * `-L` 심볼릭 링크 파일은 원본 파일의 정보를 출력
  * `-R` 하위 디렉터리 리스트 출력 

### **디렉터리 생성**

```bash
# Make directory 약어인 mkdir 명령으로 디렉터리 생성

mkdir [디렉터리명 1] [디렉터리명 2] [디렉터리명 3]
```

* 옵션
  * `-p` 하위 디렉터리 생성 시 중간 단계의 디렉터리가 없으면 자동으로 중간 디렉터리 생성

### **디렉터리 제거**

```bash
# Remove Directory 의 약어인 기존에 존재하는 디렉터리 삭제
# 여러 개 삭제 가능

rmdir [옵션] [삭제할 디렉터리 명]
```

* 디렉터리가 비어있는 것만 지울 수 있다

  ```bash
  # 비어있지 않은 디렉터리 삭제 위해 -r 옵션
  
  rm [옵션] 디렉터리명
  ```


### 파일 생성

```bash
# 파일 생성
touch [옵션]
```

* 옵션
  * `-a` 최근에 작업한 파일의 접근 시간만 변경 적용
  * `-t` 파일에 시각을 지정하여 표시

### 파일 복사

```bash
# 원본파일 hosts 를 text_01 파일로 복사
# cp [옵션] [디렉터리명/원본파일명] [복사될 파일명]
cp /etc/hosts text_01
```

* 옵션

  * `-d` 원본 파일이 심볼릭 링크된 파일일 경우에는 그 자체까지 복사
  * `-f` 복사하고자 하는 파일 이름이 겹칠 경우에는 강제 복사
  * `-i` overwirte (덮어쓰기) 옵션 &rarr; 기본적으로 사용해야 한다 (아니면 파일이 덮어 씌워져 중요한 파일 날아갈 수도)
    * **which 명령어를 통해 alias 에 -i 옵션이 있는지 항상 확인!!!**
  * `-r` : 하위 디렉터리와 파일 전체를 복사
  * `-p` : 소유주, 그룹, 권한, 시간 정보를 보존하여 복사
  * `-l` 하드 링크 형식으로 복사
  * `-s` 심볼릭 링크를 생성
    * `-S` 와 구분 (대소문자)  백업 파일을 생성할 경우 접미사를 지정

* 여러 개 복사

  ```bash
  cp [옵션] [디렉터리명1/원본파일명1] [디렉터리명2/원본파일명2] 여러 개 작성 후 .
  ```

  

### 파일 내부 정보 읽기

```bash
# 파일 내부 정보 읽기
cat [파일 이름]
```

* 옵션
  * `-n` 행을 나눠 출력

**화면 단위로 파일 내용 출력**

```bash
more [옵션] 출력할 파일명
```

* `q` 입력 시 명령문으로 다시 돌아갈 수 있다

  ```bash
  # 끝부분 10 줄
  tail
  # 머리부분 10 줄
  head
  ```

  

### 파일 찾기

```bash
# 검색 조건에 맞는 파일을 지정한 위치에서 찾는다
find 경로 검색조건 [옵션] [동작]
```

* 옵션
  * `-name` 파일 이름으로 검색
  * `-type` 파일 타입으로 검색 (`d` 디렉터리, `f` 파일, `l` 심볼릭 링크, `b` 블록 디바이스 파일)
  * `-user` 로그인 아이디로 사용자가 소유한 모든 파일 검색
  * `-perm` 지정한 접근 권한과 일치하는 파일 검색
* 동작 옵션
  * `-exec` 명령 {} \ 검색된 파일에 명령을 실행
  * `-ok` 명령 {} \ 사용자의 확인을 받아서 명령을 실행
  * `-print` 검색된 파일의 절대 경로명을 화면에 출력 (기본 동작)
  * `-ls` 검색 결과를 긴 목록 형식으로 출력

![경로](C:/daou/01.linux/doc/assets/path.png)

**find 한 경로 기준으로 절대 경로로 출력 된다**

* 예시

  ```bash
  # etc 경로에서 file 타입을, h로 시작하는 파일을 출력 하는 것
  # 단일 따옴표 써야 한다
  find /etc/ -type f -name 'h*' -print
  ```

```bash
# 파일 내에 찾고자 하는 문자열 검색
grep 
```

* 옵션

  * `-i` 대소문자를 구별하지 않고 출력
  * `-n` 찾으려는 문자열이 속해있는 행의 번호와 함께 출력

* 예시

  ```bash
   # DHCP 라는 문자열이 속해있는 파일을 /etc/services 에서 찾아서 출력 
   grep -n DHCP /etc/services
  ```

### 파일 이동

```bash
# cp 와 다르게 파일을 이동시키는 것
# 이름 바꾸는 부분도 mv 에 들어가 있다
mv [파일명] [경로]
```

